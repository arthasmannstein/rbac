# Ролевая модель доступа

Этот репозиторий содержит описанную в Markdown и YAML формате **ролевую модель доступа**, применимую к многопроектной инфраструктуре. Модель построена на принципах атомарности, агрегации и проектной изоляции.

##  Структура репозитория

```text
roles/
├── atomic/              # Атомарные роли (одна роль — одно разрешение)
├── aggregated/          # Агрегированные роли (набор атомарных, назначаются пользователям)
├── infrastructure/      # Инфраструктурные роли (по системам, без привязки к проектам)
└── projects/            # Проектные роли (ограничены scope проекта или среды)

permissions/             # Описание атомарных разрешений (например, read:gitlab)

scripts/                 # Скрипты генерации таблиц, графов и валидации
.github/workflows/       # GitHub Actions для CI/CD

docs/
└── roles_table.md       # Автоматически сгенерированная таблица ролей (Markdown)

matrix/
└── roles_table.xlsx     # Таблица ролей в Excel (для удобства ревью)

export/
└── roles_for_avanpost.yaml   # YAML-экспорт для импорта в Avanpost IDM

diagrams/
└── roles_graph.mmd      # Mermaid-граф связей ролей
```

---

##  Типы ролей

| Тип                | Назначение                                                |
|--------------------|-----------------------------------------------------------|
| **Атомарные**      | Минимальные логические блоки доступа (одна операция)      |
| **Агрегированные** | Набор атомарных ролей, отражающих функции (dev, qa, teamlead) |
| **Проектные**      | То же, что агрегированные, но ограниченные по проекту     |
| **Инфраструктурные** | Для платформенных систем: ОС, LDAP, мониторинг           |

---

##  Автоматизация (CI/CD)

GitHub Actions реализует полную автоматическую цепочку:

- Валидация модели (`validation_report.md`)
- Генерация:
  - Markdown-таблицы
  - Excel-матрицы
  - YAML-файла для Avanpost
  - Mermaid-графа
- Создание Pull Request с изменениями

Workflow: `.github/workflows/validate_and_generate.yml`

---

##  Как внести изменения

1. Отредактируйте `.md` в `roles/` или `permissions/`
2. Сделайте `commit` и `push`
3. GitHub Actions:
   - проверит модель
   - сгенерирует артефакты
   - создаст PR автоматически

---

##  Импорт в Avanpost

Экспорт `roles_for_avanpost.yaml` создаётся автоматически. Он может быть адаптирован под вашу IDM-платформу.

---

##  Отчёт валидации

Файл `validation_report.md` содержит:

- Ошибки и предупреждения по структуре модели
- Статистику по ролям и разрешениям
- Отображается в PR при любом изменении модели

---

##  Пример роли

```markdown
# Атомарная роль: gitlab-read

**Сервис:** GitLab
**Тип:** атомарная

## Разрешение
- `read:gitlab`

## Назначение
Разрешает только просмотр репозиториев и активности в GitLab.
```

---

##  Контакты / поддержка

Для вопросов по модели или интеграции с IDM обращайтесь к владельцам репозитория.
